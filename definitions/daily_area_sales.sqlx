config {
  type: "incremental",
  bigquery: {
    partitionBy: "DATE(daily_location_sales)",
    requirePartitionFilter: true,
  }
}

SELECT
  Location as location, 
  TIMESTAMP_TRUNC(Brew_Date, DAY) d, 
  SUM(Total_Sales) AS daily_location_sales
FROM
  `website-code-395711.brewery.brewery_partitioned_clustered`
GROUP BY
  location, d